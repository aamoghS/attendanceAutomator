<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Attendance Tracker Library Documentation</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            line-height: 1.6;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            color: #333;
        }
        h1 {
            border-bottom: 2px solid #333;
            padding-bottom: 10px;
        }
        h2 {
            margin-top: 30px;
            color: #2c3e50;
        }
        h3 {
            margin-top: 25px;
            color: #34495e;
        }
        .function-signature {
            background: #f5f5f5;
            padding: 15px;
            border-left: 4px solid #3498db;
            margin: 20px 0;
            font-family: 'Courier New', monospace;
            overflow-x: auto;
        }
        .description {
            margin: 15px 0;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: white;
        }
        th {
            background: #3498db;
            color: white;
            padding: 12px;
            text-align: left;
            font-weight: 600;
        }
        td {
            padding: 12px;
            border-bottom: 1px solid #ddd;
        }
        tr:hover {
            background: #f8f9fa;
        }
        .type-column {
            font-family: 'Courier New', monospace;
            color: #e74c3c;
            white-space: nowrap;
        }
        .private-tag {
            display: inline-block;
            background: #95a5a6;
            color: white;
            padding: 2px 8px;
            border-radius: 3px;
            font-size: 0.85em;
            margin-left: 10px;
        }
        .required-tag {
            display: inline-block;
            background: #e74c3c;
            color: white;
            padding: 2px 8px;
            border-radius: 3px;
            font-size: 0.85em;
            margin-left: 5px;
        }
        .github-link {
            color: #3498db;
            text-decoration: none;
        }
        .github-link:hover {
            text-decoration: underline;
        }
    </style>
</head>
<body>
    <h1>Attendance Tracker Library â€“ Google Forms to Master Spreadsheet</h1>
    
    <p><strong>GitHub:</strong> <a href="https://github.com/aamoghS/attendanceAutomator" class="github-link">https://github.com/aamoghS/attendanceAutomator</a></p>
    <p><strong>Author:</strong> Aamogh Sawant</p>
    
    <hr>
    
    <h2>importFormsToSpreadsheet(Object config)</h2>
    
    <div class="function-signature">
        importFormsToSpreadsheet(config)
    </div>
    
    <div class="description">
        <p>Main function to aggregate attendance data from multiple Google Forms into a single master spreadsheet. Tracks participation counts, prevents duplicate processing, and supports configurable folders.</p>
    </div>
    
    <h3>Arguments:</h3>
    <table>
        <thead>
            <tr>
                <th>Name</th>
                <th>Type</th>
                <th>Description</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>config</td>
                <td class="type-column">Object</td>
                <td>Configuration object containing settings for the import process</td>
            </tr>
        </tbody>
    </table>
    
    <h3>Config Properties:</h3>
    <table>
        <thead>
            <tr>
                <th>Property</th>
                <th>Type</th>
                <th>Description</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>parentFolderName<span class="required-tag">required</span></td>
                <td class="type-column">string</td>
                <td>Name of the parent folder containing forms</td>
            </tr>
            <tr>
                <td>outputSpreadsheetName<span class="required-tag">required</span></td>
                <td class="type-column">string</td>
                <td>Name of the master output spreadsheet</td>
            </tr>
            <tr>
                <td>outputSheetName<span class="required-tag">required</span></td>
                <td class="type-column">string</td>
                <td>Name of the sheet within the spreadsheet</td>
            </tr>
            <tr>
                <td>subfolderName</td>
                <td class="type-column">string</td>
                <td>Optional subfolder name to process</td>
            </tr>
            <tr>
                <td>logSheetName</td>
                <td class="type-column">string</td>
                <td>Name of log sheet (default: "Processed")</td>
            </tr>
            <tr>
                <td>skipRSVP</td>
                <td class="type-column">boolean</td>
                <td>Whether to skip forms with "RSVP" in name (default: true)</td>
            </tr>
            <tr>
                <td>verbose</td>
                <td class="type-column">boolean</td>
                <td>Enable detailed logging (default: true)</td>
            </tr>
        </tbody>
    </table>
    
    <h3>Returns:</h3>
    <table>
        <thead>
            <tr>
                <th>Type</th>
                <th>Description</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td class="type-column">Object</td>
                <td>Summary object containing processing statistics and spreadsheet URL</td>
            </tr>
        </tbody>
    </table>
    
    <hr>
    
    <h2>processFolder(...)<span class="private-tag">private</span></h2>
    
    <div class="function-signature">
        processFolder(folder, emailMap, processedForms, newlyProcessedFormIds, config, stats, indent)
    </div>
    
    <div class="description">
        <p>Recursively processes a folder and all its subfolders to find and process Google Forms. Iterates through all forms in the specified folder, extracts respondent information (name and email), updates attendance counts, and recursively processes any subfolders. Maintains processing state to avoid duplicate form processing.</p>
    </div>
    
    <h3>Arguments:</h3>
    <table>
        <thead>
            <tr>
                <th>Name</th>
                <th>Type</th>
                <th>Description</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>folder</td>
                <td class="type-column">GoogleAppsScript.Drive.Folder</td>
                <td>The folder to process</td>
            </tr>
            <tr>
                <td>emailMap</td>
                <td class="type-column">Map</td>
                <td>Map of email addresses to attendance data objects containing name and count</td>
            </tr>
            <tr>
                <td>processedForms</td>
                <td class="type-column">Set</td>
                <td>Set of form IDs that have already been processed in previous runs</td>
            </tr>
            <tr>
                <td>newlyProcessedFormIds</td>
                <td class="type-column">Set</td>
                <td>Set to collect form IDs processed in the current run</td>
            </tr>
            <tr>
                <td>config</td>
                <td class="type-column">Object</td>
                <td>Configuration object with settings like skipRSVP and verbose</td>
            </tr>
            <tr>
                <td>stats</td>
                <td class="type-column">Object</td>
                <td>Statistics object tracking forms processed, responses, and new emails</td>
            </tr>
            <tr>
                <td>indent</td>
                <td class="type-column">string</td>
                <td>String used for indentation in log output to show folder hierarchy</td>
            </tr>
        </tbody>
    </table>
    
    <hr>
    
    <h2>log(message, verbose)<span class="private-tag">private</span></h2>
    
    <div class="function-signature">
        log(message, verbose)
    </div>
    
    <div class="description">
        <p>Conditional logging helper that outputs messages only when verbose mode is enabled.</p>
    </div>
    
    <h3>Arguments:</h3>
    <table>
        <thead>
            <tr>
                <th>Name</th>
                <th>Type</th>
                <th>Description</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>message</td>
                <td class="type-column">string</td>
                <td>The message to log to the console</td>
            </tr>
            <tr>
                <td>verbose</td>
                <td class="type-column">boolean</td>
                <td>Whether verbose logging is enabled; message only prints if true</td>
            </tr>
        </tbody>
    </table>
</body>
</html>
